# Руководство пользователя
## Взаимодействие с информационной системой осуществляется через REST API. Описание методов запросов, включая их входные и выходные данные, приведено ниже.

## Регистрация пользователя в системе
```/register```
#### Описание:
POST-запрос на конечную точку /register обрабатывает регистрацию пользователя.

#### Параметры запроса:

username (строка): имя пользователя. Используется для входа в аккаунт, принимается только на английском и не может быть изменен.
password (строка): пароль пользователя. Пароль для входа в аккаунт.
nickname (строка): никнейм пользователя. Никнейм пользователя, который будет виден всем другим пользователям.
#### #### Пример запроса:
```
POST /register
Content-Type: application/x-www-form-urlencoded

username=johndoe&password=securepassword&nickname=JohnD
```

#### Ответ при успешной регистрации:
```
{
"message": "Аккаунт успешно создан"
}
```

#### Ответ при ошибке:
```
{
"message": "Пользователь с таким именем уже существует",
"exception": "UNIQUE constraint failed: Users.Login"
}
```

## Вход пользователя
```/login```
#### Описание:
POST-запрос на конечную точку /login обрабатывает вход пользователя.

#### Параметры запроса:

username (строка): имя пользователя, указанное при регистрации.
password (строка): пароль, указанный при регистрации.
#### Пример запроса:
```
POST /login
Content-Type: application/x-www-form-urlencoded

username=johndoe&password=securepassword
```

Ответ при успешном входе:
```
{
"message": "Вы вошли в аккаунт"
}
```

### Дополнительно:
В заголовке ответа Set-Cookie будет установлен session, который сохранится в браузере и будет использоваться для авторизации запросов при успешном входе.

## Загрузка видео
```/videoupload```
#### Описание:
POST-запрос на конечную точку /videoupload обрабатывает загрузку видео.

#### Параметры запроса:

video (файл): загружаемое видео.
image (файл): изображение, которое будет использоваться в качестве миниатюры видео (опционально).
name (строка): название видео.
desc (строка): описание видео.
tags (строка): теги, связанные с видео (разделены запятыми, опционально).
#### Пример запроса:
```
POST /videoupload
Content-Type: multipart/form-data

video=@video.mp4
image=@thumbnail.jpg
name=MyVideo&desc=This is a description
tags=tag1,tag2
```

Ответ при успешной загрузке:
```
{
"message": "Видеофайл успешно загружен"
}
```

## Получение рекомендованных видео
```/get_recommended_videos```
#### Описание:
GET-запрос на конечную точку /get_recommended_videos.

#### Параметры запроса:

Сессия пользователя в headers (отправляется автоматически) – опционально, так как рекомендованные видео может получить пользователь без аккаунта.
count (целое число): количество видео, которое вы хотите получить – опционально, по умолчанию отправляет 5.
#### Пример запроса:
```
GET /get_recommended_videos?count=10
Authorization: Bearer your-session-token
```

#### Ответ:
```
[
{
"video_id": 123,
"name": "Recommended Video 1",
"thumbnail": "thumbnail1.jpg",
"description": "Description of recommended video 1"
},
...
]
```

## Поиск видео или каналов
```/search```
#### Описание:
POST-запрос на конечную точку /search производит поиск видео или каналов.

#### Параметры запроса:

text (строка): текст запроса.
distance (целое число, необязательно): максимальное расстояние Левенштейна для поиска. По умолчанию равно 20.
onlyname (логический, необязательно): является ли возвращаемый результат только именами видео и каналов. По умолчанию равно false.
#### Пример запроса:
```
POST /search
Content-Type: application/json

{
"text": "funny videos",
"distance": 15,
"onlyname": true
}
```

#### Ответ:
```
[
{
"id": 456,
"name": "Funny Video Compilation",
"channel": "ComedyChannel"
},
...
]
```

## Реакция на комментарий
```/react/comment```
#### Описание:
POST-запрос на конечную точку /react/comment обрабатывает реакцию на комментарий.

#### Параметры запроса:

CommentId (целое число): ID комментария.
IsLike (логический): является ли реакция лайком или дизлайком.
#### Пример запроса:
```
POST /react/comment
Content-Type: application/json

{
"CommentId": 789,
"IsLike": true
}
```

#### Ответ:
```
{
"message": "Реакция успешно сохранена"
}
```

## Комментарий к видео
```/comment/video```
#### Описание:
POST-запрос на конечную точку /comment/video обрабатывает комментарий к видео.

#### Параметры запроса:

Text (строка): текст комментария.
VideoId (целое число): ID видео.
#### Пример запроса:
```
POST /comment/video
Content-Type: application/json

{
"Text": "Great video!",
"VideoId": 101
}
```

#### Ответ:
```
{
"message": "Комментарий успешно добавлен"
}
```

## Получение информации о профиле
```/profile/profilename:str```
#### Описание:
GET-запрос на конечную точку /profile/<profilename:str> получает информацию о профиле пользователя.

Параметры маршрута:

profilename: имя пользователя.
#### Пример запроса:
```
GET /profile/johndoe
```

#### Ответ:
```
{
"username": "johndoe",
"nickname": "JohnD",
"videos": [
{
"id": 102,
"name": "My First Video",
"thumbnail": "firstvideo.jpg"
},
...
]
}
```

#### Ответ при ошибке:
```
{
"message": "Пользователь не найден",
"status": 404
}
```

## Изменение изображения видео
```/redact_video_image```
#### Описание:
POST-запрос на конечную точку /redact_video_image.

#### Параметры запроса:

image (файл): новая картинка для видео.
VideoId (целое число): ID видео.
#### Пример запроса:
```
POST /redact_video_image
Content-Type: multipart/form-data

image=@newimage.jpg&VideoId=103
```

#### Ответ:
```
{
"message": "Картинка успешно изменена"
}
```

#### Ответ при ошибке:
```
{
"message": "Ошибка изменения картинки",
"details": "Описание ошибки"
}
```

## Информация о текущем пользователе
```/whoami```
#### Описание:
GET-запрос на конечную точку /whoami получает информацию о текущем пользователе.

#### Пример запроса:
```
GET /whoami
Authorization: Bearer your-session-token
```

#### Ответ:
```
{
"username": "johndoe",
"nickname": "JohnD",
"email": "johndoe@example.com"
}
```

Получение потока видео
```/servevideo/filename:str```
#### Описание:
GET-запрос на конечную точку /servevideo/<filename:str> обрабатывает запрос на получение потока видео.

Параметры маршрута:

filename: имя файла видео.
#### Пример запроса:
```
GET /servevideo/video.mp4
Range: bytes=0-
```

#### Ответ:
Возвращает видео-поток, начиная от указанного байта.

## Получение статического файла
```/static/filename:str```
#### Описание:
GET-запрос на конечную точку /static/<filename:str> возвращает статический файл.

Параметры маршрута:

filename: имя файла.
#### Пример запроса:
```
GET /static/image.png
```

#### Ответ:
Возвращает файл.



# Руководство для системного администратора: Как клонировать репозиторий с Git и запустить Python проект на Linux сервере

## Шаг 1: Установка Git

1. Откройте терминал на вашем сервере.
2. Установите Git, если он еще не установлен. Для этого выполните команду:
    ```sh
    sudo apt-get update
    sudo apt-get install git
    ```

## Шаг 2: Клонирование репозитория

1. В терминале выполните команду, заменив `<URL-репозитория>` на фактический URL:
    ```sh
    git clone https://github.com/TensorFlowKCPT/VideoHosting.git
    ```
2. Перейдите в каталог проекта:
    ```sh
    cd VideoHosting
    ```

## Шаг 3: Установка Python и виртуального окружения

1. Убедитесь, что Python установлен. Обычно в современных версиях Linux Python уже установлен. Проверить это можно командой:
    ```sh
    python3 --version
    ```
2. Установите `pip` (если он еще не установлен):
    ```sh
    sudo apt-get install python3-pip
    ```
3. Установите модуль `venv` для создания виртуального окружения:
    ```sh
    sudo apt-get install python3-venv
    ```

## Шаг 4: Создание и активация виртуального окружения

1. Создайте виртуальное окружение в каталоге проекта:
    ```sh
    python3 -m venv venv
    ```
2. Активируйте виртуальное окружение:
    ```sh
    source venv/bin/activate
    ```

## Шаг 5: Установка зависимостей проекта

1. Убедитесь, что вы находитесь в корневом каталоге проекта и виртуальное окружение активировано.
2. Установите все необходимые пакеты, указанные в файле `requirements.txt`:
    ```sh
    pip install -r requirements.txt
    ```

## Шаг 6: Запуск проекта

1. Обычно проект запускается с помощью определенного скрипта. Найдите в документации вашего проекта команду для запуска.
2. Например, если проект содержит файл `main.py`, выполните:
    ```sh
    python main.py
    ```

## Шаг 7: Дополнительные настройки (опционально)

1. Настройте сервер для работы в фоне. Для этого можно использовать инструменты вроде `screen`, `tmux` или системные службы (`systemd`).

Пример для `screen`:
```sh
screen -S VideoHosting
python main.py
```

Для выхода из сессии screen без завершения работы скрипта, нажмите Ctrl+A, затем D.

Для systemd создайте файл службы:

```sh
sudo nano /etc/systemd/system/video_hosting.service
```

Вставьте в него следующее содержимое, адаптировав пути к вашему проекту:

```ini
[Unit]
Description=VideoHosting
After=network.target

[Service]
User=your_user
WorkingDirectory=/path/to/your/project
ExecStart=/path/to/your/project/venv/bin/python /path/to/your/project/main.py
Restart=always

[Install]
WantedBy=multi-user.target
```

Сохраните файл и выйдите из редактора.

Активируйте и запустите службу:

```sh
sudo systemctl enable video_hosting.service
sudo systemctl start video_hosting.service
```

Теперь ваш Python проект должен работать на вашем Linux сервере.